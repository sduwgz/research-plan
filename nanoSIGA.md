# Bionano optical maps *de novo* assembly

## Introduction
The launch of the BioNano optical mapping system has greatly enhanced the performance of physical map construction. 
BioNano optical mapping technology rapidly expanded its applications in many aspects of genome research.
- guiding sequence assembly
- identification of satellite repeated sequences
- resolving haplotypes
- detection of structural variations

## Motivation
All of the applications are closely related to the length and quality of maps. As results, collecting long and high quality maps from raw sequencing data by *de novo* assembly is significate.

## Data sets
We will evaluate the proformance of the nanoARCS on both simulated and real data of four species(E.coli, P.putida, S.coel, S.pombe), and compare the results of BioNano IrysSolve assembler and IOMA assembler.

### Simulated Data
Simulated Data were generated by omsim, an open source optical map simulator. We generated three dataset(*D1*, *D2*, *D3*) with different coverage(100, 500, 1000) for four species on default error model parameters.

In order to assess the error-tolerant capability of our algorithm, we generated three datasets *E1*(low error rate), *E2*(middle error rate) and *E3*(high error rate) for E.coli. 

### Read Data
We conducted similar experments on four species produced by BioNano optical mapping thchonology. 

## Method
### Pair-wise Alignment
#### Modelling BioNano Optical Maps
According to previous studis, we know that sizing error and sites error are two major errors in Bionano optical maps. Sizing error can be modeled as a Laplace distribution Laplace(*mu, b*). Sites error contains false sites and missing sites. The number of false sites within a unit length follows a Poisson distribution, while whether a site is missing or not follows a Bernoulli trial. 
In order to avoid exhaustive pairwise alignment, we imitate kmer hashing and DDF score in short-read alignment. 
#### Resolving Alignment Conflicts

### Contiging
#### Constructing Site Graph

#### Determinating Heaviest Path

### Refinement

## Results
Dataset: *D1*
| Species | Assember | #contigs | # Aligned Contigs | N50 | Max Contig Length | Coverage | Time |
| :-----: | :------: | :------: | :---------------: | :-: | :---------------: | :------: | :--: |
| E.coli  | bioNano  |          |                   |     |                   |          |      |
|         | IOMA     |          |                   |     |                   |          |      |
|         | nanoARCS |          |                   |     |                   |          |      |
|         | nanaARCS*|          |                   |     |                   |          |      |
| P.putida | bioNano |          |                   |     |                   |          |      |
|         | IOMA     |          |                   |     |                   |          |      |
|         | nanoARCS |          |                   |     |                   |          |      |
|         | nanaARCS*|          |                   |     |                   |          |      |
| S.coel  | bioNano  |          |                   |     |                   |          |      |
|         | IOMA     |          |                   |     |                   |          |      |
|         | nanoARCS |          |                   |     |                   |          |      |
|         | nanaARCS*|          |                   |     |                   |          |      |
| S.pombe | bioNano  |          |                   |     |                   |          |      |
|         | IOMA     |          |                   |     |                   |          |      |
|         | nanoARCS |          |                   |     |                   |          |      |
|         | nanaARCS*|          |                   |     |                   |          |      |

Dataset: *D2*
| Species | Assember | #contigs | # Aligned Contigs | N50 | Max Contig Length | Coverage | Time |
| :-----: | :------: | :------: | :---------------: | :-: | :---------------: | :------: | :--: |
| E.coli  | bioNano  |          |                   |     |                   |          |      |
|         | IOMA     |          |                   |     |                   |          |      |
|         | nanoARCS |          |                   |     |                   |          |      |
|         | nanaARCS*|          |                   |     |                   |          |      |
| P.putida | bioNano |          |                   |     |                   |          |      |
|         | IOMA     |          |                   |     |                   |          |      |
|         | nanoARCS |          |                   |     |                   |          |      |
|         | nanaARCS*|          |                   |     |                   |          |      |
| S.coel  | bioNano  |          |                   |     |                   |          |      |
|         | IOMA     |          |                   |     |                   |          |      |
|         | nanoARCS |          |                   |     |                   |          |      |
|         | nanaARCS*|          |                   |     |                   |          |      |
| S.pombe | bioNano  |          |                   |     |                   |          |      |
|         | IOMA     |          |                   |     |                   |          |      |
|         | nanoARCS |          |                   |     |                   |          |      |
|         | nanaARCS*|          |                   |     |                   |          |      |
Dataset: *D3*
| Species | Assember | #contigs | # Aligned Contigs | N50 | Max Contig Length | Coverage | Time |
| :-----: | :------: | :------: | :---------------: | :-: | :---------------: | :------: | :--: |
| E.coli  | bioNano  |          |                   |     |                   |          |      |
|         | IOMA     |          |                   |     |                   |          |      |
|         | nanoARCS |          |                   |     |                   |          |      |
|         | nanaARCS*|          |                   |     |                   |          |      |
| P.putida | bioNano |          |                   |     |                   |          |      |
|         | IOMA     |          |                   |     |                   |          |      |
|         | nanoARCS |          |                   |     |                   |          |      |
|         | nanaARCS*|          |                   |     |                   |          |      |
| S.coel  | bioNano  |          |                   |     |                   |          |      |
|         | IOMA     |          |                   |     |                   |          |      |
|         | nanoARCS |          |                   |     |                   |          |      |
|         | nanaARCS*|          |                   |     |                   |          |      |
| S.pombe | bioNano  |          |                   |     |                   |          |      |
|         | IOMA     |          |                   |     |                   |          |      |
|         | nanoARCS |          |                   |     |                   |          |      |
|         | nanaARCS*|          |                   |     |                   |          |      |

Dataset: *E1*, *E2*, *E3*
| Species | Assember | #contigs | # Aligned Contigs | N50 | Max Contig Length | Coverage | Time |
| :-----: | :------: | :------: | :---------------: | :-: | :---------------: | :------: | :--: |
| *E1*    | bioNano  |          |                   |     |                   |          |      |
|         | IOMA     |          |                   |     |                   |          |      |
|         | nanoARCS |          |                   |     |                   |          |      |
|         | nanaARCS*|          |                   |     |                   |          |      |
| *E2*     | bioNano |          |                   |     |                   |          |      |
|         | IOMA     |          |                   |     |                   |          |      |
|         | nanoARCS |          |                   |     |                   |          |      |
|         | nanaARCS*|          |                   |     |                   |          |      |
| *E3*    | bioNano  |          |                   |     |                   |          |      |
|         | IOMA     |          |                   |     |                   |          |      |
|         | nanoARCS |          |                   |     |                   |          |      |
|         | nanaARCS*|          |                   |     |                   |          |      |

Dataset: *Real data*
| Species | Assember | #contigs | # Aligned Contigs | N50 | Max Contig Length | Coverage | Time |
| :-----: | :------: | :------: | :---------------: | :-: | :---------------: | :------: | :--: |
| E.coli  | bioNano  |          |                   |     |                   |          |      |
|         | IOMA     |          |                   |     |                   |          |      |
|         | nanoARCS |          |                   |     |                   |          |      |
|         | nanaARCS*|          |                   |     |                   |          |      |
| P.putida | bioNano |          |                   |     |                   |          |      |
|         | IOMA     |          |                   |     |                   |          |      |
|         | nanoARCS |          |                   |     |                   |          |      |
|         | nanaARCS*|          |                   |     |                   |          |      |
| S.coel  | bioNano  |          |                   |     |                   |          |      |
|         | IOMA     |          |                   |     |                   |          |      |
|         | nanoARCS |          |                   |     |                   |          |      |
|         | nanaARCS*|          |                   |     |                   |          |      |
| S.pombe | bioNano  |          |                   |     |                   |          |      |
|         | IOMA     |          |                   |     |                   |          |      |
|         | nanoARCS |          |                   |     |                   |          |      |
|         | nanaARCS*|          |                   |     |                   |          |      |
